2022-06-09 13:15:29.057 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755326","OrderDate":"2022-06-09T06:15:26.287Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":10.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:15:37.572 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755338","OrderDate":"2022-06-09T06:15:37.479Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:15:37.672 [ERR] Failed executing DbCommand (31ms) [Parameters=[@__rawData_OrderNo_0='?' (Size = 450), @__rawData_AppCode_1='?' (Size = 450), @__rawData_StoreNo_2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[AppCode], [t].[StoreNo], [t].[OrderNo], [t].[CrtDate], [t].[CrtUser], [t].[HostName], [t].[JsonData], [t].[PartnerCode], [t].[RequestId], [t].[UpdateFlg]
FROM [TmpTransRaw] AS [t]
WHERE (([t].[OrderNo] = @__rawData_OrderNo_0) AND ([t].[AppCode] = @__rawData_AppCode_1)) AND ([t].[StoreNo] = @__rawData_StoreNo_2)
2022-06-09 13:15:37.777 [ERR] An exception occurred while iterating over the results of a query for context type 'WCM.EntityFrameworkCore.EntityFrameworkCore.PriceEngine.PriceEngineDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
2022-06-09 13:15:37.877 [WRN] ===> SaveTmpTransRaw Exception: Invalid column name 'PartnerCode'.
2022-06-09 13:17:16.611 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755437","OrderDate":"2022-06-09T06:17:16.55Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:17:16.661 [ERR] Failed executing DbCommand (24ms) [Parameters=[@__rawData_OrderNo_0='?' (Size = 450), @__rawData_AppCode_1='?' (Size = 450), @__rawData_StoreNo_2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[AppCode], [t].[StoreNo], [t].[OrderNo], [t].[CrtDate], [t].[CrtUser], [t].[HostName], [t].[JsonData], [t].[PartnerCode], [t].[RequestId], [t].[UpdateFlg]
FROM [TmpTransRaw] AS [t]
WHERE (([t].[OrderNo] = @__rawData_OrderNo_0) AND ([t].[AppCode] = @__rawData_AppCode_1)) AND ([t].[StoreNo] = @__rawData_StoreNo_2)
2022-06-09 13:17:16.668 [ERR] An exception occurred while iterating over the results of a query for context type 'WCM.EntityFrameworkCore.EntityFrameworkCore.PriceEngine.PriceEngineDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
2022-06-09 13:17:16.702 [WRN] ===> SaveTmpTransRaw Exception: Invalid column name 'PartnerCode'.
2022-06-09 13:17:49.600 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755470","OrderDate":"2022-06-09T06:17:49.544Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:17:56.060 [ERR] Failed executing DbCommand (24ms) [Parameters=[@__rawData_OrderNo_0='?' (Size = 450), @__rawData_AppCode_1='?' (Size = 450), @__rawData_StoreNo_2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[AppCode], [t].[StoreNo], [t].[OrderNo], [t].[CrtDate], [t].[CrtUser], [t].[HostName], [t].[JsonData], [t].[PartnerCode], [t].[RequestId], [t].[UpdateFlg]
FROM [TmpTransRaw] AS [t]
WHERE (([t].[OrderNo] = @__rawData_OrderNo_0) AND ([t].[AppCode] = @__rawData_AppCode_1)) AND ([t].[StoreNo] = @__rawData_StoreNo_2)
2022-06-09 13:17:56.068 [ERR] An exception occurred while iterating over the results of a query for context type 'WCM.EntityFrameworkCore.EntityFrameworkCore.PriceEngine.PriceEngineDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PartnerCode'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:a2cc05e2-6442-4ea6-8d2c-cb317c4efcd6
Error Number:207,State:1,Class:16
2022-06-09 13:19:42.310 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755581","OrderDate":"2022-06-09T06:19:41.017Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:19:46.623 [ERR] Failed executing DbCommand (44ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [TmpTransRaw] ([AppCode], [StoreNo], [OrderNo], [CrtDate], [CrtUser], [HostName], [JsonData], [PartnerCode], [RequestId], [UpdateFlg])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2022-06-09 13:19:46.740 [ERR] An exception occurred in the database while saving changes for context type 'WCM.EntityFrameworkCore.EntityFrameworkCore.PriceEngine.PriceEngineDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'PartnerCode', table 'PriceEngine.dbo.TmpTransRaw'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__188_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:060e063d-4c25-44ca-a0f2-e9481d9afb27
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'PartnerCode', table 'PriceEngine.dbo.TmpTransRaw'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__188_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:060e063d-4c25-44ca-a0f2-e9481d9afb27
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2022-06-09 13:19:46.782 [WRN] ===> SaveTmpTransRaw Exception: Cannot insert the value NULL into column 'PartnerCode', table 'PriceEngine.dbo.TmpTransRaw'; column does not allow nulls. INSERT fails.
The statement has been terminated.
2022-06-09 13:21:43.067 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755701","OrderDate":"2022-06-09T06:21:41.317Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:24:38.798 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755877","OrderDate":"2022-06-09T06:24:37.125Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
2022-06-09 13:25:07.319 [WRN] ===> request: {"Items":[{"LineId":1,"ParentLineId":0,"ItemNo":"65000001","ItemName":"Cà phê đen nóng","Uom":"LY","OldPrice":40000.0,"UnitPrice":40000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PAPER","Size":"M","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"DUMMY005","OptionType":"BINHTHUONG","OptionName":null,"Uom":"DV","Qty":1.0}],"DiscountEntry":null},{"LineId":2,"ParentLineId":0,"ItemNo":"65000113","ItemName":"Trà Vải - Lài","Uom":"LY","OldPrice":45000.0,"UnitPrice":45000.0,"Quantity":0.0,"DiscountAmount":5000.0,"LineAmount":40000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"PLASTIC","Size":"L","IsTopping":false,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":400.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":[{"LineId":1,"ItemNo":"BINHTHUONG","OptionType":"BINHTHUONG","OptionName":"Đá","Uom":"DV","Qty":1.0}],"DiscountEntry":[{"LineId":1,"OfferNo":null,"OfferType":null,"Quantity":0.0,"DiscountAmount":500.0,"Note":"Giảm giá trực tiếp"}]},{"LineId":3,"ParentLineId":2,"ItemNo":"65000123","ItemName":"Nhãn thêm (4 trái)","Uom":"LY","OldPrice":15000.0,"UnitPrice":15000.0,"Quantity":0.0,"DiscountAmount":0.0,"LineAmount":15000.0,"TaxGroupCode":"4","VatPercent":10,"Note":"","CupType":"","Size":"","IsTopping":true,"IsCombo":false,"ComboId":0,"ArticleType":"","Barcode":"","IsLoyalty":false,"Loyalty":[{"LineId":1,"MemberCardNumber":"84559111027","ClubCode":"CVL","LoyaltyPointsEarn":150.0,"LoyaltyPointsRedeem":0.0}],"OptionEntry":null,"DiscountEntry":null}],"Payments":[{"LineId":1,"PaymentMethod":"EW50","CurrencyCode":"VND","ExchangeRate":1.0,"AmountTendered":95000.0,"AmountInCurrency":95000.0,"TransactionNo":"PLH1653882481378"}],"AppCode":"PLH","PartnerCode":"PKO","OrderNo":"20011654755907","OrderDate":"2022-06-09T06:25:07.252Z","StoreNo":"2001","CustName":"CHỊ THẮNG","CustAddress":"141 Lương Thế Vinh, Thanh Xuân, Hà Nội","CustPhone":"098989898","Note":"Tại chỗ","Status":0,"SaleTypeId":10,"TotalAmount":95000.0,"PaymentAmount":0.0,"ShippingFee":0.0,"HasVatInvoice":true,"BillingInfo":{"TaxID":"03095762215","CustName":"CÔNG TY TNHH SỨC BẬT","CompanyName":"CÔNG TY TNHH SỨC BẬT","Address":"TẦNG 15, TOÀ NHÀ VINCOM CENTER, SỐ 72 LÊ THÁNH TÔN, PHƯỜNG BẾN TRE, QUẬN 10, TPHCM","Phone":"098986598","Email":"diachiemail@gmail.com","Note":"Hóa đơn GTGT"},"UseCoupon":null}
